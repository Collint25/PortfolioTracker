<div class="flex flex-wrap gap-2 items-center">
    <!-- Show assigned groups -->
    {% for group in groups %}
    <a href="/trade-groups/{{ group.id }}" class="badge badge-primary gap-1 cursor-pointer hover:badge-primary-focus">
        {{ group.name }}
        {% if group.strategy_type %}
        <span class="text-xs opacity-70">({{ group.strategy_type | replace('_', ' ') | title }})</span>
        {% endif %}
    </a>
    {% endfor %}

    {% set assigned_group_ids = groups | map(attribute='id') | list %}

    <!-- Dropdown to add to a group -->
    {% if all_groups %}
    {% set available_groups = all_groups | rejectattr('id', 'in', assigned_group_ids) | list %}
    {% if available_groups %}
    <div class="dropdown dropdown-end">
        <label tabindex="0" class="btn btn-ghost btn-xs">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-4 h-4 stroke-current">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            Add to Group
        </label>
        <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52">
            {% for group in available_groups %}
            <li>
                <button
                    hx-post="/trade-groups/{{ group.id }}/add/{{ transaction_id }}"
                    hx-target="#transaction-trade-groups"
                >
                    {{ group.name }}
                </button>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    {% endif %}

    {% if not groups %}
    <span class="text-base-content/60 text-sm">Not in any trade group</span>
    {% endif %}
</div>
